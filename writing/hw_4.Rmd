---
title: "hw_4_rmd"
author: "Alyssa Melvin"
date: "October 24, 2018"
output: word_document
---

```{r}
library(readr)
library(dplyr)
library(tidyr)

homicides <- read_csv("../data/homicide-data.csv") 

homicides <- homicides %>% 
  unite(city_name, "city", "state", sep = ", " )

unsolved <- homicides %>% 
  filter(disposition %in% c("Closed without arrest", "Open/No arrest")) %>% 
  group_by(city_name) %>% 
  count() %>% 
  rename(n_homicides = "n")

homicides <- homicides %>% 
  group_by(city_name) %>% 
  count() %>% 
  rename(n_homicides = "n")


prop_by_city <- function(city){
  
  library(broom)
  library(purrr)
  
  city_unsolved <- unsolved %>% 
    filter(city_name == city)
  
  city_total <- homicides %>% 
    filter(city_name == city)
  
  city <- prop.test(x = city_unsolved$n_homicides,
                    n = city_total$n_homicides,
                    conf.level = 0.95)
  
tidy(city)
  
}


baltimore <- prop_by_city("Baltimore, MD")





  

```